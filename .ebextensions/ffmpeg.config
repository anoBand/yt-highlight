# .ebextensions/ffmpeg.config
commands:
  01_install_rpmfusion_free:
    # Install the RPM Fusion 'free' repository configuration. 
    # This provides open-source software that Fedora/Amazon cannot ship directly.
    # We use dnf, the modern package manager for Amazon Linux 2023.
    command: "sudo dnf install -y https://mirrors.rpmfusion.org/free/el/rpmfusion-free-release-9.noarch.rpm"
    test: "! ffmpeg -version"

  02_install_rpmfusion_nonfree:
    # Install the RPM Fusion 'nonfree' repository for software with restrictive licenses.
    # This is often where codecs required by ffmpeg reside.
    command: "sudo dnf install -y https://mirrors.rpmfusion.org/nonfree/el/rpmfusion-nonfree-release-9.noarch.rpm"
    test: "! ffmpeg -version"

  03_install_ffmpeg:
    # Now that the repositories are enabled, install ffmpeg.
    command: "sudo dnf install -y ffmpeg"
    test: "! ffmpeg -version"