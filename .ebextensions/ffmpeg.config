# .ebextensions/ffmpeg.config
commands:
  01_install_epel:
    # This command installs the configuration for the EPEL repository.
    # This is the direct and correct way to add EPEL to an AL2023 system.
    command: "sudo dnf install -y epel-release"
    test: "! rpm -q epel-release"

  02_install_rpmfusion_repos:
    # Now that EPEL is present, we can install the RPM Fusion repositories.
    # We combine them into one command for efficiency.
    command: "sudo dnf install -y --nogpgcheck https://mirrors.rpmfusion.org/free/el/rpmfusion-free-release-9.noarch.rpm https://mirrors.rpmfusion.org/nonfree/el/rpmfusion-nonfree-release-9.noarch.rpm"
    test: "! rpm -q rpmfusion-free-release"

  03_install_ffmpeg:
    # With all repositories correctly set up, finally install ffmpeg.
    command: "sudo dnf install -y ffmpeg ffmpeg-devel"
    test: "! ffmpeg -version"