# .ebextensions/ffmpeg.config
commands:
  01_enable_epel:
    # Enable EPEL repository using amazon-linux-extras
    # The 'test' command ensures this only runs if EPEL is not already enabled.
    command: "sudo amazon-linux-extras install -y epel"
    test: "! yum repolist | grep -q epel"
  
  02_install_ffmpeg:
    # Install ffmpeg from EPEL
    # The 'test' command ensures this only runs if ffmpeg is not already installed.
    command: "sudo yum install -y ffmpeg"
    test: "! ffmpeg -version"

  # Optional: Clean yum cache if there were issues finding packages previously
  # 03_clean_yum_cache:
  #   command: "sudo yum clean all"
  #   test: "true" # Always run this if uncommented, or add a more specific test